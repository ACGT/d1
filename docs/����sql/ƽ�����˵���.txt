平安现金正式订单数据
select  membercode,transnum,senddate,basepoints,attchamount,tuihuodate from pauplog 
where senddate>='2011-1-1' and senddate<'2011-2-1'
and (status=2 
--or (status=-2 and  tuihuodate>='2011-2-1')
) order by senddate

select top 10 * from pauplog

平安现金次月退货数据
select  membercode,transnum,senddate,basepoints,attchamount,tuihuodate from pauplog where  senddate<'2011-1-1'
and status=-2 and tuihuodate>='2011-1-1' and tuihuodate<'2011-2-1' order by senddate

平安积分次月退货
select pinganodr_ttnumber,pinganodr_odrid,pinganodr_memberid,pinganodr_tttime,pinganodr_amount,pinganodr_tuitime
 from pinganodr
where   pinganodr_tttime>'2011-1-1' and   pinganodr_tttime<'2011-2-1' 
and pinganodr_status=-1 and pinganodr_ctnumber in 
(select pinganodr_odrid from pinganodr where pinganodr_tttime<'2011-1-1' --and   pinganodr_tttime>'2010-4-1'
 and pinganodr_status=0 )

平安积分 正式订单
select top 10 * from pinganodr where pinganodr_odrid='110323008311'
select pinganodr_ttnumber,pinganodr_odrid,pinganodr_memberid,pinganodr_tttime,pinganodr_amount,OdrMst_shipfee
 from pinganodr b join odrmst_recent on odrmst_odrid=pinganodr_odrid

where pinganodr_memberid<>''
and ( (pinganodr_tttime>'2011-4-1' and pinganodr_tttime<'2011-5-1' and pinganodr_status=0 and pinganodr_ctnumber='') or 
(pinganodr_status=-2 and 
(select top 1 pinganodr_tuitime from pinganodr where pinganodr_odrid=b.pinganodr_odrid and pinganodr_status=-1)>='2011-5-1')) 
and pinganodr_amount>5 
--and pinganodr_odrid='110323008311'


select pinganodr_ttnumber,pinganodr_odrid,pinganodr_memberid,pinganodr_tttime,pinganodr_amount,OdrMst_shipfee
 from pinganodr b join odrmst on odrmst_odrid=pinganodr_odrid

where  pinganodr_tttime>'2011-1-1' and pinganodr_tttime<'2011-2-1' 
and ( pinganodr_status=0 or 
(pinganodr_status=-2 and 
(select top 1 pinganodr_tuitime from pinganodr where pinganodr_odrid=b.pinganodr_odrid and pinganodr_status=-1)>='2011-2-1')) 
and pinganodr_amount>5

 and pinganodr_odrid in (
'100901000357'
,'100901000467'
,'100905002049'
,'100826000516'
,'100924000018'
,'100810002164'
,'100929007603')

100810002164


select * from pinganodr where pinganodr_odrid in ('100810001126','100826000516','100823002173')




select *

 from pinganodr join odrmst on odrmst_odrid=pinganodr_odrid

where pinganodr_tttime<'2010-7-1' and pinganodr_tttime>'2010-6-1' 
and (pinganodr_status=0 or 
(pinganodr_status=-2 and
 pinganodr_tuitime>'2010-7-1')) and pinganodr_amount>5




select top 50 * from pinganodr where  pinganodr_tttime>'2010-09-1' and pinganodr_status in (-1,-2)



pinganodr_odrid in ('100612002059','100626000485','100627001934','100628002195','100629001235')

select * from pauplog where transnum='100518900815'
