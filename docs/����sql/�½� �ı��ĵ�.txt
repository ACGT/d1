select * into  olmodr_sohuvip from (
select odrmst_odrid as 订单号,odrdtl_subodrid as 子订单号,odrdtl_gdsid as 商品编号,odrdtl_gdsname as 商品名称
,odrdtl_rackcode as 分类号,odrdtl_finalprice as 商品单价,odrdtl_sendcount as 数量
,odrdtl_finalprice*odrdtl_sendcount as 商品总价,odrdtl_lmcommision as 佣金比例,'是' as 是否用券,
odrdtl_finalprice*odrdtl_sendcount*odrdtl_lmcommision as 佣金金额,@which as 联盟,'是' as 是否有效,odrmst_orderdate as 订单日期,odrmst_temp
from odrdtl,odrmst where odrmst_odrid=odrdtl_odrid and odrdtl_creatdate>=@date_s and odrdtl_creatdate<@date_e
and (odrdtl_specialflag & 2)=0 and odrdtl_jcflag=0
and substring(odrmst_temp,1,'sohuvip')='sohuvip'
and odrmst_tktvalue>0
and odrdtl_shipstatus=3
and odrdtl_gifttype='') a
--and odrmst_odrid not in (select 订单号 from olmodr_sohuvip where 订单日期>=@date_s and 订单日期<@date_e)

insert into olmodr_sohuvip
select odrmst_odrid as 订单号,odrdtl_subodrid as 子订单号,odrdtl_gdsid as 商品编号,odrdtl_gdsname as 商品名称
,odrdtl_rackcode as 分类号,odrdtl_finalprice as 商品单价,odrdtl_sendcount as 数量
,odrdtl_finalprice*odrdtl_sendcount as 商品总价,odrdtl_lmcommision as 佣金比例,'否' as 是否用券,
odrdtl_finalprice*odrdtl_sendcount*odrdtl_lmcommision as 佣金金额,@which as 联盟,'是' as 是否有效,odrmst_orderdate as 订单日期,odrmst_temp
from odrdtl,odrmst where odrmst_odrid=odrdtl_odrid and odrdtl_creatdate>=@date_s and odrdtl_creatdate<@date_e
and (odrdtl_specialflag & 2)=0 and odrdtl_jcflag=0
and substring(odrmst_temp,1,'sohuvip')='sohuvip'
and odrmst_tktvalue=0
and odrdtl_shipstatus=3
and odrdtl_gifttype=''
and odrmst_odrid not in (select 订单号 from olmodr_sohuvip where 订单日期>=@date_s and 订单日期<@date_e)