
--利用随机数生成D1券 Start
declare @rnd int
declare @count int
declare @str varchar(200)
declare @start varchar(50)
declare @rndflag varchar(50)
declare @rnd2 int

set @count=1
while @count<=20001
  begin
    set @start='000000000'+cast(@count as varchar)
    set @rnd=cast( floor(rand()*10000000) as int)
    set @rnd2=cast( floor(rand()*10000000) as int)
    set @rnd=@rnd+@rnd2
    set @rnd=cast( floor(rand()*@rnd) as int)
    set @rndflag='0000000000'+cast(@rnd as varchar)
    set @str='d1101_mm21007'+right(@start,4)
    set @str=@str+right(@rndflag,5)
    --set @rnd=cast( floor(rand()*@rnd) as int)
    --set @rndflag='0000000000'+cast(@rnd as varchar)
    --set @str=@str+right(@rndflag,4)
   if not exists(select cardno from cardno100428 where cardno=@str)
      begin
	set nocount on --不返回"所影响行数"
	insert into cardno100428 (cardno) 
	values(@str) 
	--print @str
	set @count=@count+1
      end
    else
      continue      
end

select * from cardno100428 where cardno not in (select top 100000 cardno from cardno100428 order by cardno desc) order by cardno desc

insert into tktcrd (tktcrd_cardno,tktcrd_value,tktcrd_realvalue,tktcrd_discount,tktcrd_type,tktcrd_validflag,
	tktcrd_enddate,tktcrd_validates,tktcrd_validatee) 
select distinct(cardno),50,50,0.15,'004003',0,'2010-09-30 23:59:59','2010-07-27','2010-09-30 23:59:59' from cardno100428 order by cardno desc




insert into tktpwd (tktpwd_cardno,tktpwd_pwd,tktpwd_value,tktpwd_enddate,tktpwd_gdsvalue,tktpwd_rackcode,
tktpwd_sendcount,tktpwd_maxcount,tktpwd_everymaxcount,tktpwd_createdate,tktpwd_tktstartdate,tktpwd_tktenddate,tktpwd_mbrid,tktpwd_ifvip,tktpwd_sprckcodestr,tktpwd_baihuo)
select distinct(cardno),'www.d1.com.cn',10,'2010-9-30 23:59:59',10,'000',0,1,1,getdate(),'2010-07-27','2010-9-30 23:59:59',0,0,'',0 from cardno100428 order by cardno desc



select count(*) from tktcrd where 
--tktpwd_cardno='D43_0224243196380'

tktcrd_cardno like 'd1101_kaba1005%'

create table cardno100428(cardno varchar(50))

select * from cardno100428

delete from cardno100428

drop table cardno100223

select *  from tencenttktmail where status=0
