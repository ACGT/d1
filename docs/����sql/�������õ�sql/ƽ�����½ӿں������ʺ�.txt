
insert into updatepaid (updatepaid_mbrmstuid,updatepaid_memberid,updatepaid_mbrid1,updatepaid_mbrid2)
select mbrmstpingan_mbrmstuid,mbrmstpingan_memberid,mbrmstpingan_mbrid,(select mbrmstpingan_mbrid 
 from mbrmstpingan b where b.mbrmstpingan_memberid=mbrmstpingan.mbrmstpingan_memberid and
 b.mbrmstpingan_mbrid>mbrmstpingan.mbrmstpingan_mbrid)  as  mbrmstpingan_mberid2
from mbrmstpingan where len(mbrmstpingan_mbrmstuid)<>datalength(mbrmstpingan_mbrmstuid) and mbrmstpingan_memberid in
(select mbrmstpingan_memberid  From mbrmstpingan
where mbrmstpingan_memberid not in (select updatepaid_memberid from updatepaid)
 group by mbrmstpingan_memberid having count(mbrmstpingan_memberid)>=2) order by mbrmstpingan_memberid



更新订单中会员帐号id  odrmst_history和odrmst两个表

update odrmst_history set odrmst_mbrid=(select updatepaid_mbrid2 from updatepaid where updatepaid_mbrid1=odrmst_history.odrmst_mbrid)  
where odrmst_mbrid in (select updatepaid_mbrid1 from updatepaid) 

select * from updatepaid where updatepaid_mbrid1 in (select odrmst_mbrid from odrmst) order by updatepaid_mbrid1
select *,updatepaid_mbrid2  from odrmst_history 
join updatepaid on updatepaid_mbrid1=odrmst_mbrid
where odrmst_mbrid in (select updatepaid_mbrid1 from updatepaid) order by odrmst_mbrid

