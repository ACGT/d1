select top 200 badrcd.*,badip_site from badrcd left outer join badip on badrcd_ip=badip_ip
--select count(*),count(distinct badrcd_ip) from badrcd
where 1=1
--select * from badrcd where 1=1
--select distinct badrcd_ip from badrcd
--and badrcd_page like '/htmfl/woman%'
and badrcd_page like '/html/gdsshow.asp%'
--and badrcd_ip='61.174.170.218'
--and badrcd_from  like 'http://www.google%'
and badrcd_createdate>'2010-2-1' and badrcd_createdate<'2010-2-2'
order by badrcd_createdate desc

select ticdtl_month,sum(ticdtl_actureincome) from ticdtl where ticdtl_year=2010
group by ticdtl_month

select top 100 * from lmclk 
where lmclk_uid='d1_1101'
order by lmclk_createdate desc

p_lockinfo --查看杀掉死锁存储过程
select * from mbrmst where mbrmst_id=4127 
select * from dba.odrdtl_history where odrdtl_odrid='060406000818'
select top 10 * from badrcd091128
--点出查询
select substring(badrcd_page,1,10),count(*),count(distinct badrcd_ip)
--select top 1000 *
--select count(*)
from badrcd where badrcd_createdate>'2010-2-1' and badrcd_createdate<'2010-2-2'
--from homesrc where homesrc_createdate>'2006-12-10' and homesrc_createdate<'2006-12-11'
--and badrcd_domain = 'www.hao123.com' order by badrcd_createdate desc
--and badrcd_from = 'http://www.d1.com.cn/html/man/' --order by badrcd_createdate desc
group by substring(badrcd_page,1,10) order by count(distinct badrcd_ip) desc



select ctymst_id,prvmst_name,ctymst_name from ctymst inner join prvmst on ctymst_provinceid=prvmst_provinceid
order by prvmst_name,ctymst_name

prvmst_provinceid prvmst_name


select badrcd_from,count(*),count(distinct badrcd_ip)
--select top 1000 *
from badrcd where badrcd_createdate>'2010-1-19' and badrcd_createdate<'2010-1-20'
and badrcd_page='/index.asp'
group by badrcd_from order by count(distinct badrcd_ip) desc

select count(*) from mbrmst where mbrmst_createdate>'2009-3-1'
and mbrmst_id not in (select odrmst_mbrid from odrmst where odrmst_orderdate>'2009-3-1')

select count(*) from odrdtl where odrdtl_creatdate>'2009-1-1'

select top 100 badrcd_page,count(distinct badrcd_ip),count(*) from badrcd left outer join badip on badrcd_ip=badip_ip
--select badrcd_page,count(distinct badrcd_ip),count(*) from badrcd
where 1=1
--select * from badrcd where 1=1
--select distinct badrcd_ip from badrcd
and badrcd_Domain='www.baidu.com'
and badrcd_createdate>'2009-7-22' and badrcd_createdate<'2009-7-23'  
group by badrcd_page
order by count(*) desc

sp_who_lock

select count(distinct lmclk_ip),count(*) from d1clk  where lmclk_subad='x' 
--select * from d1clk where lmclk_subad='x'
and lmclk_createdate>'2009-3-4' and lmclk_createdate<'2009-3-5'
--and lmclk_ip='123.120.14.88'
--and lmclk_linkurl<>'http://shop8.x.com.cn/index5.php?id=d1&xcom=7'
order by lmclk_createdate desc

select * 
--select count(distinct lmclk_ip),count(*) 
from lmclk where lmclk_uid='baidu2009' order by lmclk_createdate desc

select lmclk_uid,lmclk_subad,count(distinct lmclk_ip),count(*) from d1clk  
--select  * from d1clk
where lmclk_uid<>'d1_9999' and lmclk_uid<>''
--select * from d1clk where lmclk_uid<>'d1_9999'
and lmclk_createdate>'2009-2-17' and lmclk_createdate<'2009-2-19'
--order by lmclk_createdate desc
--group by lmclk_uid,lmclk_subad 
order by lmclk_uid,lmclk_subad  desc
order by count(distinct lmclk_ip) desc


select sum(odrdtl_gdscount) from odrdtl inner join odrmst on odrmst_odrid=odrdtl_odrid
and odrmst_orderstatus>0 and odrmst_orderdate>'2009-2-1' 


select substring(odrdtl_rackcode,1,3),count(*),count(distinct odrdtl_gdsid) from odrdtl 
where odrdtl_creatdate>'2009-1-1' and odrdtl_shipstatus=3 and odrdtl_purtype<>4
group by substring(odrdtl_rackcode,1,3)
order by count(*) desc

select * from tktmst where tktmst_cardno like 'd1091_sh%' and tktmst_validflag=1

select * from smssnddtl where smsid=15 and ifsend=0

sp_who_lock
select substring(gdsmst_rackcode,1,3),count(*) from gdsmst 
where gdsmst_validflag=1 group by substring(gdsmst_rackcode,1,3)
order by count(*)

select * from tktmst where tktmst_cardno='d1091_sohu090330000065508924 '

select * from maildtl where maildtl_mailid=131
select * from rckmst where rakmst_rackcode like '015%'
select * from heike order by crdate desc
select count(*) from mbrmst where mbrmst_bookletflag=1

select len(minimst_dtl) from minimst order by len(minimst_dtl)
select * from mbrmst where mbrmst_lastdate>'2009-1-29' and mbrmst_lastdate<'2009-1-30'
select * from smssnddtl where smsid=9 and ifsend=1
order by senddate desc
select count(*) from mbrmst where mbrmst_email like '%21cn.com'

select badrcd_domain,count(*),count(distinct badrcd_ip)
--select top 1000 *
from badrcd where badrcd_createdate>'2009-11-23' and badrcd_createdate<'2009-11-24'
--from homesrc061214 where homesrc_createdate>'2006-12-10' and homesrc_createdate<'2006-12-11'
--and badrcd_domain = 'www.hao123.com' order by badrcd_createdate desc
--and badrcd_from like '%gouwu.youdao.com%' order by badrcd_createdate desc
group by badrcd_domain order by count(distinct badrcd_ip) desc


select badrcd_from,count(*),count(distinct badrcd_ip),min(badrcd_page)
--select top 1000 *
from badrcd where badrcd_createdate>'2009-11-23' and badrcd_createdate<'2009-11-24'
--from homesrc061214 where homesrc_createdate>'2006-12-10' and homesrc_createdate<'2006-12-11'
and badrcd_domain = 'www.baidu.com'
--and badrcd_page like 'http://www.baidu%' --order by badrcd_createdate desc
group by badrcd_from order by count(distinct badrcd_ip) desc



select top 100 * from searchlog_081009 order by searchlog_createdate desc

select top 1000 * from badrcd where badrcd_createdate>'2008-12-8' and badrcd_createdate<'2008-12-9'
and badrcd_ip='220.200.170.137'
218.91.93.183

select count(*) ,count(distinct lmclk_ip) from lmclk where lmclk_createdate>'2008-12-15' and lmclk_uid='d1_9999' 
and lmclk_subad='081215merry' order by lmclk_Createdate desc

select * 
--select count(*) ,count(distinct lmclk_ip)
from lmclk where lmclk_createdate>'2008-12-17' and lmclk_uid='d1_1087' 
and lmclk_subad='08nrsd' order by lmclk_Createdate desc

sp_who_lock
select mbrmst_id,min(mbrmst_uid),min(mbrmst_name),min(mbrmst_usephone),min(mbrmst_haddr),min(mbrmst_birthday),max(odrmst_orderdate)
from mbrmst inner join odrmst on mbrmst_id=odrmst_mbrid 
where month(mbrmst_birthday) in (12,1) and mbrmst_vipenddate>'2199-1-1' and odrmst_orderdate>0
group by mbrmst_id

select mbrmst_birthflag,* from mbrmst where mbrmst_id=160827

select mbrmst_name,rscitm_title,rscopt_title,rscdtl.* from Rscdtl inner join mbrmst on mbrmst_id=rscdtl_mbrid
inner join rscitm on rscdtl_itemid=rscitm_id 
inner join rscopt on rscdtl_optionid=rscopt_id
where rscdtl_rscid=4 order by rscdtl_createdate,mbrmst_name,rscitm_id,rscopt_id

select count(*) from mbrmst where mbrmst_email like '%vip.sina.com%'
select sum(odrdtl_gdscount) from odrdtl where odrdtl_creatdate>'2008-9-10' and odrdtl_creatdate<'2008-9-11'
163.com 73933
126.com 30622
sina.com 29760
yahoo.com.cn 57594
sohu.com 14874
qq.com 19347
tom.com 8051
21cn.com 4955
gmail.com 2422
yahoo.com 2309
sina.com.cn 1897
263.net 1844
vip.sina.com 1714
yahoo.cn 847 1729


sp_who_lock
select count(*) from mbrmst where mbrmst_downflag=1
select * from odrdtl where odrdtl_downflag=1
select top 200 badrcd.*,badip_site from badrcd left outer join badip on badrcd_ip=badip_ip
--select distinct badrcd_ip from badrcd
where 1=1
--select * from badrcd where 1=1
--select distinct badrcd_ip from badrcd
and badrcd_ip='116.16.216.150'
--and badrcd_page like '/buy/final%'
--and badrcd_from like 'http://www.hao123%'
--and badrcd_from <>''
--and badrcd_createdate>'2008-2-22'-- and badrcd_createdate<'2008-2-12'
order by badrcd_createdate desc

sp_who_lock
insert into mailmst mailmst_memo,mailmmst_title,mailmst_content,mailmst_mbrnum,mailmst_type,mailmst_r
select top 10 * from gdsmst
select gdsmst_gdsid,gdsmst_gdsname,gdsmst_detailintruduce,gdsmst_saleprice,gdsmst_memberprice,'http://images.d1.com.cn'+gdsmst_imgurl
from gdsmst where gdsmst_validflag=1 and 
(gdsmst_rackcode like '15002014%' or gdsmst_rackcode like '015008%' 
or gdsmst_rackcode like '017002008008%' or gdsmst_rackcode like '010003006%')

--市场新算法
select  odrmst_mbrid,sum(odrmst_gdsmoney-odrmst_tktvalue),max(odrmst_gdsmoney-odrmst_tktvalue) from odrmst where odrmst_mbrid in 
(select mktmbr_mbrid from mktmbr where mktmbr_createdate>'2008-4-1')
and odrmst_orderdate>'2008-4-1' and odrmst_orderstatus in (3,31,5,51,6,61) group by odrmst_mbrid

where mbrmst_createdate>'2008-6-26' and mbrmst_note like '080626%' order by mbrmst_lastdate desc

select substring(odrdtl_rackcode,1,9),sum(odrdtl_finalprice*odrdtl_sendcount) from odrdtl 
where odrdtl_creatdate>'2008-5-1' and odrdtl_creatdate<'2008-6-1' and odrdtl_rackcode like '015002%'
and odrdtl_shipstatus=3 group by substring(odrdtl_rackcode,1,9) 
order by sum(odrdtl_finalprice*odrdtl_sendcount) desc
select 
select * from maildtl where maildtl_mailid=82
sp_who_lock

select 'http://www.d1.com.cn'+badrcd_page,badrcd_page,count(*) from badrcd left outer join badip on badrcd_ip=badip_ip
--select * from badrcd
where 1=1
and badrcd_page='/html/special/barbie/barbie.asp'
and badrcd_from like 'http://www.google%' 
--and badrcd_createdate>'2008-2-11' and badrcd_createdate<'2008-2-12'
group by badrcd_page
order by count(*) desc

select top 10 * from badip order by badip_createdate desc
select * from mbrmst where mbrmst_uid='d1_1101'
select * from odrmst where odrmst_odrid='080107000064'
--update odrmst set odrmst_peoplercm=186461 where odrmst_orderdate>'2008-1-1' and odrmst_srcurl like 'http://www.bol%' 
and odrmst_peoplercm is null

sp_who_lock
select * from gdsmst where gdsmst_rackcode like '015002004%'  and gdsmst_memberprice>=1000

select top 20 gdsmst_inprice,gdsmst_inprice/gdsmst_saleprice,gdsmst_saleprice,gdsmst_vipprice,round(gdsmst_saleprice*0.75,2) 
--select count(*) 
update gdsmst set gdsmst_inprice=round(gdsmst_saleprice*0.75,2)
where gdsmst_rackcode like '001%' or gdsmst_rackcode like '002%'
and gdsmst_provide='00000628' and gdsmst_validflag=1

select gdsmst_stock,* from gdsmst where gdsmst_gdsid='01701146'
--truncate table badrcd
select * from badip order by badip_createdate desc
sp_who_lock

select * from badip where badip_ip='61.129.77.228' order by badip_createdate desc
select count(*) from gdsmst

select badrcd_ip,count(*) from badrcd where badrcd_createdate>'2006-12-22' and badrcd_createdate<'2006-12-23'
and badrcd_page='/index.asp' and badrcd_from='' group by badrcd_ip order by count(*) desc


select badrcd_from,count(*) from badrcd where badrcd_createdate>'2006-12-22' and badrcd_createdate<'2006-12-23'
and badrcd_page='/index.asp'
 group by badrcd_from order by count(*) desc

select top 10 * from gdsmst where gdsmst_rackcode like '002%' and gdsmst_validflag=1
select gdsmst_rackcode,count(*) from gdsmst where gdsmst_rackcode like  '001014%' 
group by gdsmst_rackcode order by gdsmst_rackcode

sp_who_lock
select * from badrcd where badrcd_page = '/html/zhuanti/061219wanju/wanju.asp' order by badrcd_createdate desc

select count(distinct badrcd_ip) from badrcd where badrcd_from like 'http://club.alipay.com/yy/mk/hls/list.html%'
and badrcd_page like '/html/gdsshow.asp%'

select count(*) from badrcd where badrcd_ip in
(select badrcd_ip from badrcd where badrcd_from like 'http://club.alipay.com/yy/mk/hls/list.html%')
and badrcd_page like '/html/gdsshow_ss.asp%')


11488

2447

select top 10 * from badrcd 
order by badrcd_createdate desc
select count(*) from gdsmst where gdsmst_createdate<'2006-9-24'
select top 10 * from badrcd where badrcd_from like 'http://www.baidu%'
select * from badrcd where badrcd_ip='221.220.166.245' order by badrcd_createdate desc

select * from badrcd where badrcd_page like '%payaction=06112901%'

select * from badip order by badip_createdate desc

select * from badip order by badip_createdate desc


select convert(int,sum((odrdtl_finalprice-odrdtl_purprice-odrdtl_eyuan)*odrdtl_sendcount))
 from odrdtl inner join odrmst  on odrmst_odrid=odrdtl_odrid where odrmst_mbrid not in (10185 ,110918 )  
and odrdtl_shipstatus in (2,3 )
and odrdtl_rackcode like '015009%'
and odrdtl_creatdate>'2008-9-1'

select top 20 year(mbrmst_createdate),month(mbrmst_createdate),day(mbrmst_createdate),count(*)
from mbrmst group by year(mbrmst_createdate),month(mbrmst_createdate),day(mbrmst_createdate)
order by count(*) desc

select top 20 year(odrmst_orderdate),month(odrmst_orderdate),day(odrmst_orderdate),count(*),sum(odrmst_gdsmoney)
from odrmst where odrmst_orderstatus>0
group by year(odrmst_orderdate),month(odrmst_orderdate),day(odrmst_orderdate)
--order by count(*) desc
order by sum(odrmst_gdsmoney) desc


select top 20 year(odrdtl_creatdate),month(odrdtl_creatdate),day(odrdtl_creatdate),sum(odrdtl_sendcount)
from odrdtl where odrdtl_shipstatus in (2,3)
group by year(odrdtl_creatdate),month(odrdtl_creatdate),day(odrdtl_creatdate)
order by count(*) desc

select top 100 odrdtl_odrid,odrdtl_gdsid,odrdtl_gdsname,odrdtl_finalprice,odrdtl_incomevalue,odrdtl_gdscount,
(odrdtl_finalprice-odrdtl_incomevalue)*odrdtl_gdscount from odrdtl
where odrdtl_creatdate>'2009-4-1' and odrdtl_shipstatus in (2,3)
order by (odrdtl_finalprice-odrdtl_incomevalue)*odrdtl_gdscount desc


select odrdtl_odrid,odrdtl_gdsid,odrdtl_gdsname,(odrdtl_finalprice-odrdtl_purprice-odrdtl_eyuan-gdsmst_othercost)*odrdtl_sendcount
from odrdtl inner join gdsmst on gdsmst_gdsid=odrdtl_gdsid
where odrdtl_creatdate>'2009-9-1' and odrdtl_shipstatus in (2,3)
and odrdtl_rackcode like '014%'
order by (odrdtl_finalprice-odrdtl_purprice-odrdtl_eyuan-gdsmst_othercost)*odrdtl_sendcount


select odrmst_subad,odrmst_mbrid,odrdtl_odrid,odrdtl_gdsid,odrdtl_gdsname,(odrdtl_finalprice-odrdtl_purprice-odrdtl_eyuan-gdsmst_othercost)*odrdtl_sendcount
from odrdtl inner join gdsmst on gdsmst_gdsid=odrdtl_gdsid
inner join odrmst on odrmst_odrid=odrdtl_Odrid
where odrdtl_creatdate>'2009-9-1' and odrdtl_shipstatus in (2,3)
and odrdtl_rackcode like '012%'
order by (odrdtl_finalprice-odrdtl_purprice-odrdtl_eyuan-gdsmst_othercost)*odrdtl_sendcount
