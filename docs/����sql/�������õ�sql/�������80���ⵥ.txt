truncate table odr8znreal
insert into odr8znreal(odrid)
select  odrmst_odrid from odrmst_cache where 
odrmst_orderdate>=convert(varchar(10),getdate()-1)
 and odrmst_orderdate<convert(varchar(10),getdate())
insert into odr8znreal(odrid)
select  odrmst_odrid from odrmst where 
odrmst_orderdate>=convert(varchar(10),getdate()-1)
 and odrmst_orderdate<convert(varchar(10),getdate())
insert into odr8znreal(odrid)
select  odrmst_odrid from odrmst_recent where 
odrmst_orderdate>=convert(varchar(10),getdate()-1)
 and odrmst_orderdate<convert(varchar(10),getdate())

declare @k int
declare @P int
declare @OdridBody varchar(20)
declare @odrid varchar(20)
declare @price int
declare @count int
declare @maxodrid int
select @maxodrid=cast(right(max(odrid),6) as int) from odr8znreal


set @count=1
while @count<=72
begin
set @k = cast(rand()*@maxodrid as int)
set @P= cast(rand()*1000 as int)

if (@P<=50)
set @price=cast(rand()*40 as int)+10
else if (@P>50 and @P<=650)
set @price=cast(rand()*200 as int)+50
else if (@P>650 and @P<=950)
set @price=cast(rand()*749 as int)+250
else 
set @price=cast(rand()*200 as int)+1000

set @OdridBody =rtrim(ltrim(str(@k)))

set @odrid=right(Year(getdate()),2)+right('00'+rtrim(cast(Month(getdate()) as char)),2)
+right('00'+rtrim(cast(Day(getdate()-1) as char)),2)+right('000000'+@OdridBody,6)
    if not exists(select top 1 1 from odr8znwin where odr8znwin_odrid=@odrid) and  not exists(select top 1 1 from odr8znreal where odrid=@odrid)
      begin
	set nocount on --不返回"所影响行数"
	insert into odr8znwin(odr8znwin_odrid,odr8znwin_price,odr8znwin_flag)
        values(@odrid,@price,1)
	set @count=@count+1
      end
    else
      continue      
end